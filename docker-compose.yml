services:
  registry:
    image: registry:latest
    container_name: registry
    networks:
      - infra-vps
    volumes:
      - ./volume-registry:/var/lib/registry
  registry-ui:
    image: konradkleine/docker-registry-frontend:latest
    container_name: registry-ui
    ports:
      - 1100:80
    networks:
      - infra-vps
    environment:
      ENV_DOCKER_REGISTRY_HOST: registry
      ENV_DOCKER_REGISTRY_PORT: 5000
  caddy:
    image: caddy:latest
    container_name: caddy
    expose:
      - 80
      - 443
    ports:
      - 80:80
      - 443:443
    volumes:
      - ./volume-caddy/Caddyfile:/etc/caddy/Caddyfile
      - ./volume-caddy/site:/srv
      - ./volume-caddy/caddy_data:/data
      - ./volume-caddy/caddy_config:/config
    networks:
      - infra-vps
    restart: always
  portfolio-2024:
    build:
      context: ./../atelier-heloir/.
      dockerfile: Dockerfile.portfolio-2024
    container_name: portfolio-2024
    networks:
      - infra-vps

networks:
  infra-vps:
